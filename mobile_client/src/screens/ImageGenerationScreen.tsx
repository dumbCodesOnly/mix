/**\n * Image Generation Screen - Generate images from text prompts.\n */\n\nimport React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  ScrollView,\n  StyleSheet,\n  ActivityIndicator,\n  Image,\n  Alert,\n} from 'react-native';\n\nimport { getAPIClient } from '../services/api';\nimport { getCacheService } from '../services/cache';\nimport { getStorageService } from '../services/storage';\nimport { COLORS, SPACING, FONT_SIZES } from '../utils/constants';\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: COLORS.BACKGROUND,\n  },\n  scrollContent: {\n    padding: SPACING.MD,\n  },\n  inputContainer: {\n    marginBottom: SPACING.LG,\n  },\n  label: {\n    fontSize: FONT_SIZES.MD,\n    fontWeight: 'bold',\n    color: COLORS.TEXT,\n    marginBottom: SPACING.SM,\n  },\n  input: {\n    borderWidth: 1,\n    borderColor: COLORS.BORDER,\n    borderRadius: 8,\n    padding: SPACING.MD,\n    fontSize: FONT_SIZES.MD,\n    color: COLORS.TEXT,\n    minHeight: 100,\n    textAlignVertical: 'top',\n  },\n  button: {\n    backgroundColor: COLORS.PRIMARY,\n    padding: SPACING.MD,\n    borderRadius: 8,\n    alignItems: 'center',\n    marginBottom: SPACING.LG,\n  },\n  buttonText: {\n    fontSize: FONT_SIZES.MD,\n    fontWeight: 'bold',\n    color: COLORS.BACKGROUND,\n  },\n  imageContainer: {\n    marginTop: SPACING.LG,\n    borderRadius: 8,\n    overflow: 'hidden',\n  },\n  image: {\n    width: '100%',\n    height: 400,\n    backgroundColor: COLORS.DISABLED,\n  },\n  loadingContainer: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: SPACING.LG,\n  },\n});\n\nexport default function ImageGenerationScreen() {\n  const [prompt, setPrompt] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [generatedImage, setGeneratedImage] = useState<string | null>(null);\n\n  const handleGenerateImage = async () => {\n    if (!prompt.trim()) {\n      Alert.alert('Error', 'Please enter a prompt');\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      const apiClient = getAPIClient();\n      const cacheService = getCacheService();\n      const storageService = getStorageService();\n\n      // Check cache first\n      const cachedImage = await cacheService.getCachedImage(prompt);\n      if (cachedImage) {\n        setGeneratedImage(cachedImage);\n        setIsLoading(false);\n        return;\n      }\n\n      // Generate image\n      const imageBlob = await apiClient.generateImage({\n        prompt,\n        height: 512,\n        width: 512,\n      });\n\n      // Cache the image\n      const imagePath = await cacheService.cacheImage(prompt, imageBlob);\n      setGeneratedImage(imagePath);\n\n      // Add to recent prompts\n      await storageService.addRecentPrompt(prompt);\n\n      Alert.alert('Success', 'Image generated successfully!');\n    } catch (error) {\n      console.error('Error generating image:', error);\n      Alert.alert('Error', 'Failed to generate image. Please try again.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <View style={styles.container}>\n      <ScrollView contentContainerStyle={styles.scrollContent}>\n        <View style={styles.inputContainer}>\n          <Text style={styles.label}>Prompt</Text>\n          <TextInput\n            style={styles.input}\n            placeholder=\"Describe the image you want to generate...\"\n            placeholderTextColor={COLORS.TEXT_SECONDARY}\n            value={prompt}\n            onChangeText={setPrompt}\n            multiline\n            editable={!isLoading}\n          />\n        </View>\n\n        <TouchableOpacity\n          style={[styles.button, isLoading && { opacity: 0.5 }]}\n          onPress={handleGenerateImage}\n          disabled={isLoading}\n        >\n          {isLoading ? (\n            <ActivityIndicator color={COLORS.BACKGROUND} />\n          ) : (\n            <Text style={styles.buttonText}>Generate Image</Text>\n          )}\n        </TouchableOpacity>\n\n        {generatedImage && (\n          <View style={styles.imageContainer}>\n            <Image\n              source={{ uri: `file://${generatedImage}` }}\n              style={styles.image}\n            />\n          </View>\n        )}\n      </ScrollView>\n    </View>\n  );\n}\n
